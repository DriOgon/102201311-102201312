import{d as e,c as a,o as t,a as l,n as s,b as o,i as n,w as i,e as u,f as d,t as c,r,g as v,Y as p,h as m,j as f,u as _,k as h,l as b,m as w,p as y,F as g,q as x,s as k,v as C,x as $,y as I,z,A as T,B as N,C as S,D as j,S as L,E as V,G as H,H as M,I as G,J as R,K as E,L as X,M as B,N as F}from"./index-CKmb8B-R.js";import{b as Y,m as A,a as P,c as W,i as U,d as D,o as J,e as K,n as q,f as O,g as Q,u as Z,h as ee,j as ae,k as te}from"./props.DIUoDIPf.js";import{_ as le}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as se,o as oe,a as ne,b as ie,c as ue,d as de}from"./uni-app.es.C8008jpp.js";import{_ as ce}from"./wd-icon.CKzk4z_r.js";import{g as re,a as ve,h as pe,b as me,s as fe}from"./index.B98IQ2cJ.js";import{e as _e}from"./commonCloud.CgNnOc-F.js";import{s as he}from"./store.D0bvSpmK.js";import{_ as be}from"./default-avatar.DPaE08He.js";import{u as we,a as ye}from"./useChildren.Cmfbpnhq.js";import{u as ge}from"./useTranslate.DFMOv7A2.js";import"./config.defalut.Bve--ZPF.js";const xe=le(e({name:"wd-gap",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...Y,bgColor:A("transparent"),safeAreaBottom:P(!1),height:W(15)},setup(e){const i=e,u=a((()=>{const e={};return U(i.bgColor)&&(e.background=i.bgColor),U(i.height)&&(e.height=D(i.height)),`${J(e)};${i.customStyle}`}));return(e,a)=>{const i=n;return t(),l(i,{class:s(`wd-gap ${e.safeAreaBottom?"wd-gap--safe":""} ${e.customClass}`),style:o(u.value)},null,8,["class","style"])}}}),[["__scopeId","data-v-8f900e47"]]),ke=le(e({name:"wd-card",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...Y,type:String,title:String,customTitleClass:A(""),customContentClass:A(""),customFooterClass:A("")},setup:e=>(e,a)=>{const p=v,m=n;return t(),l(m,{class:s(["wd-card","rectangle"==e.type?"is-rectangle":"",e.customClass]),style:o(e.customStyle)},{default:i((()=>[u(m,{class:s(["wd-card__title-content",e.customTitleClass])},{default:i((()=>[u(m,{class:"wd-card__title"},{default:i((()=>[e.title?(t(),l(p,{key:0},{default:i((()=>[d(c(e.title),1)])),_:1})):r(e.$slots,"title",{key:1},void 0,!0)])),_:3})])),_:3},8,["class"]),u(m,{class:s(`wd-card__content ${e.customContentClass}`)},{default:i((()=>[r(e.$slots,"default",{},void 0,!0)])),_:3},8,["class"]),u(m,{class:s(`wd-card__footer ${e.customFooterClass}`)},{default:i((()=>[r(e.$slots,"footer",{},void 0,!0)])),_:3},8,["class"])])),_:3},8,["class","style"])}}),[["__scopeId","data-v-60a2ad07"]]),Ce=le(e({__name:"blog-item",props:{blog:{}},emits:["updateList"],setup(e,{emit:o}){const r=p.database(),{blog:v}=e,T=o,N=m(0),S=a((()=>!!he.hasLogin&&!(he.userInfo._id!==v.user_id[0]._id&&!pe())));a((()=>he.userInfo.nickname||he.userInfo.username||he.userInfo.mobile||"微信用户"));const j=e=>{$({itemList:["删除","编辑"],success:function(a){var t;0===a.tapIndex&&(e=>{z({title:"是否确认删除？此操作不可逆！",success(a){a.confirm&&r.collection("travel-articles").doc(e).update({delete_status:0}).then((()=>{k({title:"删除成功！",icon:"none"}),T("updateList",e)})).catch((e=>{k({title:e.message||"删除失败，请联系管理员",icon:"none"})}))}})})(e),1===a.tapIndex&&(t=e,fe.set("acticleId",t),I({url:"/pages/publish/publish"}))},fail:function(e){console.log(e.errMsg)}})};return(e,a)=>{const o=x,r=n,p=se(f("wd-icon"),ce),m=se(f("wd-card"),ke);return t(),l(r,null,{default:i((()=>[u(m,{type:"rectangle"},{title:i((()=>[u(r,{class:"blog-title"},{default:i((()=>{var s,n;return[u(o,{src:(null==(n=null==(s=e.blog.user_id[0])?void 0:s.avatar_file)?void 0:n.url)??_(be),width:"40",height:"40",alt:"travel-avatar"},null,8,["src"]),u(r,{class:"user-name"},{default:i((()=>{var a,t;return[d(c((null==(a=e.blog.user_id[0])?void 0:a.nickname)||(null==(t=e.blog.user_id[0])?void 0:t.username)||"微信用户"),1)]})),_:1}),u(r,{class:"create-time"},{default:i((()=>[d(c(_(re)(e.blog.last_modify_date)),1)])),_:1}),S.value?(t(),l(r,{key:0,class:"more-action",onClick:a[0]||(a[0]=h((a=>j(e.blog._id)),["stop"]))},{default:i((()=>[d("···")])),_:1})):b("",!0)]})),_:1})])),footer:i((()=>[u(r,{class:"blog-footer"},{default:i((()=>[u(r,{class:"operation-icon"},{default:i((()=>[u(p,{name:"browse",size:"36rpx"}),u(r,null,{default:i((()=>[d(c(e.blog.view_count),1)])),_:1})])),_:1}),u(r,{class:s(["operation-icon",e.blog.isLike?"active":""]),onClick:a[1]||(a[1]=h((e=>(async()=>{if(!me())return;const e=Date.now();if(e-N.value<2e3)return k({title:"操作太频繁，请稍后...",icon:"none"});v.isLike?v.like_count--:v.like_count++,v.isLike=!v.isLike,N.value=e,_e(String(v._id))})()),["stop"]))},{default:i((()=>[u(p,{name:"thumb-up",size:"34rpx"}),u(r,null,{default:i((()=>[d(c(e.blog.like_count?e.blog.like_count:"点赞"),1)])),_:1})])),_:1},8,["class"])])),_:1})])),default:i((()=>[u(r,{class:"blog-body"},{default:i((()=>[u(r,{class:"body-title"},{default:i((()=>[d(c(e.blog.title),1)])),_:1}),u(r,{class:"body-tip"},{default:i((()=>[d(c(e.blog.excerpt),1)])),_:1}),u(r,{class:"body-image"},{default:i((()=>[(t(!0),w(g,null,y(e.blog.picurls,((e,a)=>(t(),l(o,{key:_(ve)(),src:e,mode:"aspectFill","lazy-load":"",onClick:h((e=>{return t=a,void C({urls:v.picurls,current:t});var t}),["stop"])},null,8,["src","onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-6e8be9e5"]]),$e=Symbol("wd-tabs"),Ie={...Y,modelValue:W(0),slidableNum:K(6),mapNum:K(10),sticky:P(!1),offsetTop:K(0),swipeable:P(!1),lineWidth:K(19),lineHeight:K(3),color:A(""),inactiveColor:A(""),animated:P(!1),duration:K(300)},ze=le(e({name:"wd-tab",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...Y,name:q,title:String,disabled:P(!1)},setup(e,{expose:u}){const d=e,c=m(!1),v=m(!1),{proxy:p}=N(),{parent:f,index:_}=we($e),h=a((()=>U(f)?f.state.activeIndex:0));function w(e,a){c.value=e,v.value=a}return T((()=>d.name),(e=>{!U(e)||O(e)||Q(e)?f&&function(e){const{name:a}=d;if(null==a||""===a)return;f&&f.children.forEach((t=>{t.$.uid!==e.$.uid&&t.name===a&&console.error(`The tab's bound value: ${a} has been used`)}))}(p):console.error("[wot design] error(wd-tab): the type of name should be number or string")}),{deep:!0,immediate:!0}),T((()=>h.value),(e=>{e===_.value?w(!0,!0):w(c.value,!1)}),{deep:!0,immediate:!0}),u({setShow:w,painted:c}),(e,a)=>{const u=n;return t(),l(u,{class:s(`wd-tab ${e.customClass}`),style:o(e.customStyle)},{default:i((()=>[c.value?(t(),l(u,{key:0,class:"wd-tab__body",style:o(v.value?"":"display: none;")},{default:i((()=>[r(e.$slots,"default",{},void 0,!0)])),_:3},8,["style"])):b("",!0)])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-87d003df"]]),Te=le(e({name:"wd-resize",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...Y,customContainerClass:A("")},emits:["resize"],setup(e,{emit:d}){const c=e,v=m(0),p=m(0),f=m(0),h=m(0),b=m(0),w=m(0),y=m(0),g=a((()=>{const e={width:D(w.value),height:D(b.value)};return`${J(e)};${c.customStyle}`}));let x=()=>{};const{proxy:k}=N(),C=m(`resize${Z()}`),$=d;function I({lastWidth:e,lastHeight:a}){v.value=1e5+a,p.value=3*b.value+a,f.value=1e5+e,h.value=3*w.value+e}return S((()=>{j().in(k).select(`#${C.value}`).boundingClientRect().exec((([e])=>{let a=e.height,t=e.width;b.value=a,w.value=t,x=()=>{j().in(k).select(`#${C.value}`).boundingClientRect().exec((([e])=>{if(0==y.value++){const a={};["bottom","top","left","right","height","width"].forEach((t=>{a[t]=e[t]})),$("resize",a)}if(y.value<3)return;const l=e.height,s=e.width;b.value=l,w.value=s;const o=[];if(l!==a&&(a=l,o.push(1)),s!==t&&(t=s,o.push(1)),0!==o.length){const a={};["bottom","top","left","right","height","width"].forEach((t=>{a[t]=e[t]})),$("resize",a)}I({lastWidth:t,lastHeight:a})}))},I({lastWidth:t,lastHeight:a})}))})),(e,a)=>{const d=n,c=L;return t(),l(d,{class:s(`wd-resize ${e.customClass}`),style:o(g.value)},{default:i((()=>[u(d,{id:C.value,class:s(`wd-resize__container ${e.customContainerClass}`)},{default:i((()=>[r(e.$slots,"default",{},void 0,!0),u(c,{class:"wd-resize__wrapper","scroll-y":!0,"scroll-top":v.value,"scroll-x":!0,"scroll-left":f.value,onScroll:_(x)},{default:i((()=>[u(d,{class:"wd-resize__wrapper--placeholder",style:{height:"100000px",width:"100000px"}})])),_:1},8,["scroll-top","scroll-left","onScroll"]),u(c,{class:"wd-resize__wrapper","scroll-y":!0,"scroll-top":p.value,"scroll-x":!0,"scroll-left":h.value,onScroll:_(x)},{default:i((()=>[u(d,{class:"wd-resize__wrapper--placeholder",style:{height:"250%",width:"250%"}})])),_:1},8,["scroll-top","scroll-left","onScroll"])])),_:3},8,["id","class"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-dce7c039"]]),Ne=le(e({name:"wd-sticky",options:{addGlobalClass:!0,styleIsolation:"shared"},props:{...Y,zIndex:K(1),offsetTop:K(0)},setup(e,{expose:d}){const c=e,v=m(`wd-sticky${Z()}`),p=m(!1),_=m("absolute"),h=m(0),b=m(0),w=m(0),y=m([]),g=m(""),x=V("box-height",null)||m(0),k=V("observerForChild",null),{proxy:C}=N(),$=N(),I=a((()=>{const e={"z-index":c.zIndex,height:D(b.value),width:D(w.value)};return p.value||(e.position="relative"),`${J(e)};${c.customStyle}`})),z=a((()=>{const e={"z-index":c.zIndex,height:D(b.value),width:D(w.value)};return p.value||(e.position="relative"),`${J(e)};`})),T=a((()=>{const e={position:_.value,top:D(h.value)};return J(e)})),S=a((()=>{let e=0;return e=44,44+c.offsetTop}));function j(e){w.value=e.width,b.value=e.height,function(){if(0===b.value&&0===w.value)return;const e=S.value+b.value;(function(){for(;0!==y.value.length;)y.value.pop().disconnect()})(),function(){const e=H($);return y.value.push(e),e}().relativeToViewport({top:-e}).observe(`#${v.value}`,L),ee(`#${v.value}`,!1,C).then((a=>{Number(a.bottom)<=e&&L({boundingClientRect:a})}))}(),k&&k(C)}function L({boundingClientRect:e}){if(k&&b.value>=x.value)return _.value="absolute",void(h.value=0);e.top<=S.value?(g.value="sticky",p.value=!1,_.value="fixed",h.value=S.value):e.top>S.value&&(g.value="normal",p.value=!1,_.value="absolute",h.value=0)}return d({setPosition:function(e,a,t){p.value=e,_.value=a,h.value=t},openBox:p,position:_,top:h,height:b,width:w,state:g,offsetTop:S.value}),(e,a)=>{const d=se(f("wd-resize"),Te),p=n;return t(),l(p,{style:o(`${I.value};display: inline-block;`)},{default:i((()=>[u(p,{class:s(`wd-sticky ${c.customClass}`),style:o(z.value),id:v.value},{default:i((()=>[u(p,{class:"wd-sticky__container",style:o(T.value)},{default:i((()=>[u(d,{onResize:j,"custom-style":"display: inline-block;"},{default:i((()=>[r(e.$slots,"default",{},void 0,!0)])),_:3})])),_:3},8,["style"])])),_:3},8,["class","style","id"])])),_:3},8,["style"])}}}),[["__scopeId","data-v-fe5339bc"]]),Se=le(e({name:"wd-sticky-box",options:{addGlobalClass:!0,styleIsolation:"shared"},props:Y,setup(e){const a=e,d=m(`wd-sticky-box${Z()}`),c=m(new Map),v=m(0),p=m(0),_=[],{proxy:h}=N(),b=N();function w(e){p.value=e.width,v.value=e.height;const a=c.value;c.value=new Map;for(const[t]of a){y(_.find((e=>e.$.uid===t)))}a.forEach((e=>{e.disconnect()})),a.clear()}function y(e){_.find((a=>a.$.uid===e.$.uid))||_.push(e),function(e){const a=c.value.get(e.$.uid);a&&(a.disconnect(),c.value.delete(e.$.uid))}(e);const a=function(e){const a=H(b);return c.value.set(e.$.uid,a),a}(e),t=e.$.exposed,l=t.height.value+t.offsetTop;v.value<=t.height.value&&t.setPosition(!1,"absolute",0),a.relativeToViewport({top:-l}).observe(`#${d.value}`,(e=>{g(t,e)})),ee(`#${d.value}`,!1,h).then((e=>{Number(e.bottom)<=l&&g(t,{boundingClientRect:e})}))}function g(e,{boundingClientRect:a}){const t=e.height.value+e.offsetTop;if(a.bottom<=t)e.setPosition(!0,"absolute",a.height-e.height.value);else if(a.top<=t&&a.bottom>t){if("normal"===e.state.value)return;e.setPosition(!1,"fixed",e.offsetTop)}}return M("box-height",v),M("box-width",p),M("observerForChild",y),G((()=>{c.value=new Map})),(e,d)=>{const c=se(f("wd-resize"),Te),v=n;return t(),l(v,{style:{position:"relative"}},{default:i((()=>[u(v,{class:s(`wd-sticky-box ${a.customClass}`),style:o(e.customStyle),id:"styckyBoxId"},{default:i((()=>[u(c,{onResize:w},{default:i((()=>[r(e.$slots,"default",{},void 0,!0)])),_:3})])),_:3},8,["class","style"])])),_:3})}}}),[["__scopeId","data-v-d6c4d973"]]);const je=le(e({name:"wd-tabs",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:Ie,emits:["change","disabled","click","update:modelValue"],setup(e,{expose:v,emit:p}){const h=".wd-tabs__nav-item",x=e,{translate:k}=ge("tabs"),C=R({activeIndex:0}),$=m(""),I=m(!1),z=m(0),j=m(!1),V=m(!1),{children:H,linkChildren:M}=ye($e);M({state:C});const{proxy:G}=N(),X=function(){const e=m(""),a=m(0),t=m(0),l=m(0),s=m(0),o=m(0),n=m(0);return{touchStart:function(i){const u=i.touches[0];e.value="",a.value=0,t.value=0,l.value=0,s.value=0,o.value=u.clientX,n.value=u.clientY},touchMove:function(i){const u=i.touches[0];a.value=u.clientX-o.value,t.value=u.clientY-n.value,l.value=Math.abs(a.value),s.value=Math.abs(t.value),e.value=l.value>s.value?"horizontal":l.value<s.value?"vertical":""},direction:e,deltaX:a,deltaY:t,offsetX:l,offsetY:s,startX:o,startY:n}}(),B=a((()=>H.map(((e,a)=>({disabled:e.disabled,title:e.title,name:U(e.name)?e.name:a}))))),F=a((()=>x.animated?J({left:-100*C.activeIndex+"%","transition-duration":x.duration+"ms","-webkit-transition-duration":x.duration+"ms"}):"")),Y=ae((function(e=0,a=!1,t=!0){0!==B.value.length&&(e=oe(e),B.value[e].disabled||(C.activeIndex=e,t&&(W(!1===a),D()),function(){if(!V.value)return;B.value[C.activeIndex].name!==x.modelValue&&(A("change",{index:C.activeIndex,name:B.value[C.activeIndex].name}),A("update:modelValue",B.value[C.activeIndex].name))}()))}),100,{leading:!1});T((()=>x.modelValue),(e=>{O(e)||Q(e)||console.error("[wot design] error(wd-tabs): the type of value should be number or string"),""!==e&&U(e)||console.error("[wot design] error(wd-tabs): tabs's value cannot be '' null or undefined"),"number"==typeof e&&e<0&&console.error("[wot design] error(wd-tabs): tabs's value cannot be less than zero")}),{immediate:!0,deep:!0}),T((()=>x.modelValue),(e=>{const a=oe(e);Y(e,!1,a!==C.activeIndex)}),{immediate:!1,deep:!0}),T((()=>H.length),(()=>{V.value&&E((()=>{Y(x.modelValue)}))})),T((()=>x.slidableNum),(e=>{te(e,"slidableNum")})),T((()=>x.mapNum),(e=>{te(e,"mapNum")})),S((()=>{V.value=!0,E((()=>{Y(x.modelValue,!0)}))}));const A=p;function P(){I.value?(j.value=!1,setTimeout((()=>{I.value=!1}),300)):(I.value=!0,setTimeout((()=>{j.value=!0}),100))}function W(e=!0){if(!V.value)return;const{lineWidth:a,lineHeight:t}=x;ee(h,!0,G).then((l=>{const s=l[C.activeIndex],o=a;let n=l.slice(0,C.activeIndex).reduce(((e,a)=>e+Number(a.width)),0);n+=(Number(s.width)-o)/2;const i=`\n            height: ${t}px;\n            width: ${o}px;\n            transform: translateX(${n}px);\n            ${e?"transition: width 300ms ease, transform 300ms ease;":""}\n          `;$.value!==i&&($.value=i)}))}function D(){V.value&&Promise.all([ee(h,!0,G),ee(".wd-tabs__nav-container",!1,G)]).then((([e,a])=>{const t=e[C.activeIndex],l=e.slice(0,C.activeIndex).reduce(((e,a)=>e+a.width),0)-(a.width-Number(t.width))/2;l===z.value?z.value=l+Math.random()/1e4:z.value=l}))}function K(e){if(void 0===e)return;const{name:a,disabled:t}=B.value[e];t?A("disabled",{index:e,name:a}):(I.value&&P(),Y(e),A("click",{index:e,name:a}))}function q(e){x.swipeable&&X.touchStart(e)}function Z(e){x.swipeable&&X.touchMove(e)}function le(){if(!x.swipeable)return;const{direction:e,deltaX:a,offsetX:t}=X;"horizontal"===e.value&&t.value>=50&&(a.value>0&&0!==C.activeIndex?Y(C.activeIndex-1):a.value<0&&C.activeIndex!==B.value.length-1&&(Y(C.activeIndex+1),Y(C.activeIndex+1)))}function oe(e){if(O(e)&&e>=B.value.length&&(console.error("[wot design] warning(wd-tabs): the type of tabs' value is Number shouldn't be less than its children"),e=0),Q(e)){const a=B.value.findIndex((a=>a.name===e));e=-1===a?0:a}return e}return v({setActive:Y,scrollIntoView:D,updateLineStyle:W,children:H}),(e,a)=>{const v=n,p=L,m=se(f("wd-icon"),ce),h=se(f("wd-sticky"),Ne),x=se(f("wd-sticky-box"),Se);return e.sticky?(t(),l(x,{key:0},{default:i((()=>[u(v,{class:s(`wd-tabs ${e.customClass} ${e.slidableNum<B.value.length?"is-slide":""} ${e.mapNum<B.value.length&&0!==e.mapNum?"is-map":""}`),style:o(e.customStyle)},{default:i((()=>[u(h,{"offset-top":e.offsetTop},{default:i((()=>[u(v,{class:"wd-tabs__nav wd-tabs__nav--sticky"},{default:i((()=>[u(v,{class:"wd-tabs__nav--wrap"},{default:i((()=>[u(p,{"scroll-x":e.slidableNum<B.value.length,"scroll-with-animation":"","scroll-left":z.value},{default:i((()=>[u(v,{class:"wd-tabs__nav-container"},{default:i((()=>[(t(!0),w(g,null,y(B.value,((a,n)=>(t(),l(v,{onClick:e=>K(n),key:n,class:s(`wd-tabs__nav-item  ${C.activeIndex===n?"is-active":""} ${a.disabled?"is-disabled":""}`),style:o(C.activeIndex===n?e.color?"color:"+e.color:"":e.inactiveColor?"color:"+e.inactiveColor:"")},{default:i((()=>[d(c(a.title),1)])),_:2},1032,["onClick","class","style"])))),128)),u(v,{class:"wd-tabs__line",style:o($.value)},null,8,["style"])])),_:1})])),_:1},8,["scroll-x","scroll-left"])])),_:1}),e.mapNum<B.value.length&&0!==e.mapNum?(t(),l(v,{key:0,class:"wd-tabs__map"},{default:i((()=>[u(v,{class:s("wd-tabs__map-btn  "+(j.value?"is-open":"")),onClick:P},{default:i((()=>[u(v,{class:s("wd-tabs__map-arrow  "+(j.value?"is-open":""))},{default:i((()=>[u(m,{name:"arrow-down"})])),_:1},8,["class"])])),_:1},8,["class"]),u(v,{class:"wd-tabs__map-header",style:o(`${I.value?"":"display:none;"}  ${j.value?"opacity:1;":""}`)},{default:i((()=>[d(c(_(k)("all")),1)])),_:1},8,["style"]),u(v,{class:s("wd-tabs__map-body  "+(j.value?"is-open":"")),style:o(I.value?"":"display:none")},{default:i((()=>[(t(!0),w(g,null,y(B.value,((a,n)=>(t(),l(v,{class:"wd-tabs__map-nav-item",key:n,onClick:e=>K(n)},{default:i((()=>[u(v,{class:s(`wd-tabs__map-nav-btn ${C.activeIndex===n?"is-active":""}  ${a.disabled?"is-disabled":""}`),style:o(C.activeIndex===n?e.color?"color:"+e.color+";border-color:"+e.color:"":e.inactiveColor?"color:"+e.inactiveColor:"")},{default:i((()=>[d(c(a.title),1)])),_:2},1032,["class","style"])])),_:2},1032,["onClick"])))),128))])),_:1},8,["class","style"])])),_:1})):b("",!0)])),_:1})])),_:1},8,["offset-top"]),u(v,{class:"wd-tabs__container",onTouchstart:q,onTouchmove:Z,onTouchend:le,onTouchcancel:le},{default:i((()=>[u(v,{class:s(["wd-tabs__body",e.animated?"is-animated":""]),style:o(F.value)},{default:i((()=>[r(e.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"])])),_:3}),u(v,{class:"wd-tabs__mask",style:o(`${I.value?"":"display:none;"} ${j.value?"opacity:1;":""}`),onClick:P},null,8,["style"])])),_:3},8,["class","style"])])),_:3})):(t(),l(v,{key:1,class:s(`wd-tabs  ${e.customClass} ${e.slidableNum<B.value.length?"is-slide":""} ${e.mapNum<B.value.length&&0!==e.mapNum?"is-map":""}`)},{default:i((()=>[u(v,{class:"wd-tabs__nav"},{default:i((()=>[u(v,{class:"wd-tabs__nav--wrap"},{default:i((()=>[u(p,{"scroll-x":e.slidableNum<B.value.length,"scroll-with-animation":"","scroll-left":z.value},{default:i((()=>[u(v,{class:"wd-tabs__nav-container"},{default:i((()=>[(t(!0),w(g,null,y(B.value,((a,n)=>(t(),l(v,{onClick:e=>K(n),key:n,class:s(`wd-tabs__nav-item ${C.activeIndex===n?"is-active":""} ${a.disabled?"is-disabled":""}`),style:o(C.activeIndex===n?e.color?"color:"+e.color:"":e.inactiveColor?"color:"+e.inactiveColor:"")},{default:i((()=>[d(c(a.title),1)])),_:2},1032,["onClick","class","style"])))),128)),u(v,{class:"wd-tabs__line",style:o($.value)},null,8,["style"])])),_:1})])),_:1},8,["scroll-x","scroll-left"])])),_:1}),e.mapNum<B.value.length&&0!==e.mapNum?(t(),l(v,{key:0,class:"wd-tabs__map"},{default:i((()=>[u(v,{class:"wd-tabs__map-btn",onClick:P},{default:i((()=>[u(v,{class:s("wd-tabs__map-arrow "+(j.value?"is-open":""))},{default:i((()=>[u(m,{name:"arrow-down"})])),_:1},8,["class"])])),_:1}),u(v,{class:"wd-tabs__map-header",style:o(`${I.value?"":"display:none;"}  ${j.value?"opacity:1;":""}`)},{default:i((()=>[d(c(_(k)("all")),1)])),_:1},8,["style"]),u(v,{class:s("wd-tabs__map-body "+(j.value?"is-open":"")),style:o(I.value?"":"display:none")},{default:i((()=>[(t(!0),w(g,null,y(B.value,((e,a)=>(t(),l(v,{class:"wd-tabs__map-nav-item",key:a,onClick:e=>K(a)},{default:i((()=>[u(v,{class:s(`wd-tabs__map-nav-btn ${C.activeIndex===a?"is-active":""}  ${e.disabled?"is-disabled":""}`)},{default:i((()=>[d(c(e.title),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1},8,["class","style"])])),_:1})):b("",!0)])),_:1}),u(v,{class:"wd-tabs__container",onTouchstart:q,onTouchmove:Z,onTouchend:le,onTouchcancel:le},{default:i((()=>[u(v,{class:s(["wd-tabs__body",e.animated?"is-animated":""]),style:o(F.value)},{default:i((()=>[r(e.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"])])),_:3}),u(v,{class:"wd-tabs__mask",style:o(`${I.value?"":"display:none;"}  ${j.value?"opacity:1":""}`),onClick:P},null,8,["style"])])),_:3},8,["class"]))}}}),[["__scopeId","data-v-fdbf8b3c"]]),Le=le(e({__name:"home",setup(e){const a=p.database(),s=a.command;let o=m([]);const r=R([{title:"最新",name:"latest"},{title:"热门",name:"hot"}]),v=m("latest"),h=m("latest"),b=m(""),x=R({page:1,pageSize:10,total:0}),k=m(!0),C=async()=>{const{pageSize:e}=x;b.value="加载中...";const t=a.collection("travel-articles").where("article_status == 1 && delete_status == 1 && is_open == true").field("user_id, view_count, like_count, comment_count, title, excerpt, picurls, publish_date").orderBy("latest"===h.value?"publish_date":"view_count","desc").skip(o.value.length).limit(e).getTemp(),l=a.collection("uni-id-users").field("_id, username, nickname, avatar_file").getTemp();await a.collection(t,l).get({getCount:!0}).then((async t=>{var l;const n=t.result.data;if(!o.value.length&&n.length<e&&(k.value=!1),0===n.length)return k.value=!1;if(he.hasLogin){const{uid:e}=p.getCurrentUserInfo();let t=[];n.forEach((e=>t.push(e._id)));(await a.collection("travel-like").where({article_id:s.in(t),user_id:e}).get()).result.data.forEach((e=>{let a=n.findIndex((a=>e.article_id==a._id));n[a].isLike=!0}))}x.total=(null==(l=t.result)?void 0:l.count)||0,o.value=[...o.value,...n]})).catch((()=>{k.value=!1})).finally((()=>{b.value=k.value?"上拉加载更多":"暂无更多数据",B()}))},$=e=>{h.value=e.name,o.value=[],k.value=!0,C()};return oe((()=>({title:"旅拍路书，旅行爱好者必备旅拍记录工具",path:"/pages/home/home"}))),ne((()=>{X(),C()})),ie((()=>{o.value=[],k.value=!0,C()})),ue((()=>{k.value&&C()})),de((()=>{fe.set("currentRoute","home")})),(e,a)=>{const s=se(f("wd-gap"),xe),p=se(f("blog-item"),Ce),m=n,h=L,x=se(f("wd-tab"),ze),k=se(f("wd-tabs"),je);return t(),l(m,{class:"content"},{default:i((()=>[u(k,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=e=>v.value=e),animated:"",swipeable:"",onChange:$},{default:i((()=>[(t(!0),w(g,null,y(r,(e=>(t(),l(x,{key:e.name,title:e.title,name:e.name},{default:i((()=>[u(h,{"scroll-y":"true"},{default:i((()=>[u(m,{class:"main"},{default:i((()=>[u(s,{height:"85rpx"}),(t(!0),w(g,null,y(_(o),(e=>(t(),l(m,{class:"alone",key:e._id,onClick:a=>{return t=e._id,void F({url:"/subpackages/sub_home/article-details/article-details?id="+t});var t}},{default:i((()=>[u(p,{blog:e,onUpdateList:a=>(e=>{const a=o.value.findIndex((a=>a._id===e));-1!==a&&o.value.splice(a,1)})(e._id)},null,8,["blog","onUpdateList"])])),_:2},1032,["onClick"])))),128)),u(m,{class:"load-text"},{default:i((()=>[d(c(b.value),1)])),_:1})])),_:2},1024)])),_:2},1024)])),_:2},1032,["title","name"])))),128))])),_:1},8,["modelValue"])])),_:1})}}}),[["__scopeId","data-v-18e35555"]]);export{Le as default};
